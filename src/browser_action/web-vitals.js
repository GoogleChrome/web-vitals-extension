var t,e,n=function(){return self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},r=function(t){if("loading"===document.readyState)return"loading";var e=n();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}return"complete"},i=function(t){var e=t.nodeName;return 1===t.nodeType?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},a=function(t,e){var n="";try{for(;t&&9!==t.nodeType;){var r=t,a=r.id?"#"+r.id:i(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(n.length+a.length>(e||100)-1)return n||a;if(n=n?a+">"+n:a,r.id)break;t=r.parentNode}}catch(t){}return n},o=-1,u=function(){return o},c=function(t){addEventListener("pageshow",(function(e){e.persisted&&(o=e.timeStamp,t(e))}),!0)},s=function(){var t=n();return t&&t.activationStart||0},f=function(t,e){var r=n(),i="navigate";u()>=0?i="back-forward-cache":r&&(document.prerendering||s()>0?i="prerender":document.wasDiscarded?i="restore":r.type&&(i=r.type.replace(/_/g,"-")));return{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},l=function(t,e,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var r=new PerformanceObserver((function(t){Promise.resolve().then((function(){e(t.getEntries())}))}));return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch(t){}},d=function(t,e,n,r){var i,a;return function(o){e.value>=0&&(o||r)&&((a=e.value-(i||0))||void 0===i)&&(i=e.value,e.delta=a,e.rating=function(t,e){return t>e[1]?"poor":t>e[0]?"needs-improvement":"good"}(e.value,n),t(e))}},m=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},p=function(t){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&t()}))},v=function(t){var e=!1;return function(){e||(t(),e=!0)}},h=-1,g=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},T=function(t){"hidden"===document.visibilityState&&h>-1&&(h="visibilitychange"===t.type?t.timeStamp:0,E())},y=function(){addEventListener("visibilitychange",T,!0),addEventListener("prerenderingchange",T,!0)},E=function(){removeEventListener("visibilitychange",T,!0),removeEventListener("prerenderingchange",T,!0)},S=function(){return h<0&&(h=g(),y(),c((function(){setTimeout((function(){h=g(),y()}),0)}))),{get firstHiddenTime(){return h}}},b=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},L=[1800,3e3],C=function(t,e){e=e||{},b((function(){var n,r=S(),i=f("FCP"),a=l("paint",(function(t){t.forEach((function(t){"first-contentful-paint"===t.name&&(a.disconnect(),t.startTime<r.firstHiddenTime&&(i.value=Math.max(t.startTime-s(),0),i.entries.push(t),n(!0)))}))}));a&&(n=d(t,i,L,e.reportAllChanges),c((function(r){i=f("FCP"),n=d(t,i,L,e.reportAllChanges),m((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},M=[.1,.25],w=function(t,e){!function(t,e){e=e||{},C(v((function(){var n,r=f("CLS",0),i=0,a=[],o=function(t){t.forEach((function(t){if(!t.hadRecentInput){var e=a[0],n=a[a.length-1];i&&t.startTime-n.startTime<1e3&&t.startTime-e.startTime<5e3?(i+=t.value,a.push(t)):(i=t.value,a=[t])}})),i>r.value&&(r.value=i,r.entries=a,n())},u=l("layout-shift",o);u&&(n=d(t,r,M,e.reportAllChanges),p((function(){o(u.takeRecords()),n(!0)})),c((function(){i=0,r=f("CLS",0),n=d(t,r,M,e.reportAllChanges),m((function(){return n()}))})),setTimeout(n,0))})))}((function(e){!function(t){if(t.entries.length){var e=t.entries.reduce((function(t,e){return t&&t.value>e.value?t:e}));if(e&&e.sources&&e.sources.length){var n=(i=e.sources).find((function(t){return t.node&&1===t.node.nodeType}))||i[0];if(n)return void(t.attribution={largestShiftTarget:a(n.node),largestShiftTime:e.startTime,largestShiftValue:e.value,largestShiftSource:n,largestShiftEntry:e,loadState:r(e.startTime)})}}var i;t.attribution={}}(e),t(e)}),e)},x=function(t,e){C((function(e){!function(t){if(t.entries.length){var e=n(),i=t.entries[t.entries.length-1];if(e){var a=e.activationStart||0,o=Math.max(0,e.responseStart-a);return void(t.attribution={timeToFirstByte:o,firstByteToFCP:t.value-o,loadState:r(t.entries[0].startTime),navigationEntry:e,fcpEntry:i})}}t.attribution={timeToFirstByte:0,firstByteToFCP:t.value,loadState:r(u())}}(e),t(e)}),e)},A=0,I=1/0,k=0,F=function(t){t.forEach((function(t){t.interactionId&&(I=Math.min(I,t.interactionId),k=Math.max(k,t.interactionId),A=k?(k-I)/7+1:0)}))},D=function(){"interactionCount"in performance||t||(t=l("event",F,{type:"event",buffered:!0,durationThreshold:0}))},P=[],B=new Map,R=0,q=function(){return(t?A:performance.interactionCount||0)-R},H=[],N=self.requestIdleCallback||self.setTimeout,O=self.cancelIdleCallback||self.clearTimeout,j=function(t){var e=-1;return"hidden"===document.visibilityState?t():(e=N(t),p((function(){O(e),t()}))),e},U=[200,500],V=function(t,e){e=e||{},b((function(){var n,r;D();var i,a=f("INP"),o=null!==(n=e.durationThreshold)&&void 0!==n?n:40,u=function(t){t.forEach((function(t){"first-input"===t.entryType&&t.duration>=o||function(t){if(H.forEach((function(e){return e(t)})),t.interactionId||"first-input"===t.entryType){var e=P[P.length-1],n=B.get(t.interactionId);if(n||P.length<10||t.duration>e.latency){if(n)t.duration>n.latency?(n.entries=[t],n.latency=t.duration):t.duration===n.latency&&t.startTime===n.entries[0].startTime&&n.entries.push(t);else{var r={id:t.interactionId,latency:t.duration,entries:[t]};B.set(r.id,r),P.push(r)}P.sort((function(t,e){return e.latency-t.latency})),P.length>10&&P.splice(10).forEach((function(t){return B.delete(t.id)}))}}}(t)}));var e,n=(e=Math.min(P.length-1,Math.floor(q()/50)),P[e]);n&&n.latency!==a.value&&(a.value=n.latency,a.entries=n.entries,i())},s=l("event",u,{durationThreshold:null!==(r=e.durationThreshold)&&void 0!==r?r:40});i=d(t,a,U,e.reportAllChanges),s&&("PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),p((function(){u(s.takeRecords()),a.value<0&&q()>0&&(a.value=0,a.entries=[]),i(!0)})),c((function(){R=0,P.length=0,B.clear(),a=f("INP"),i=d(t,a,U,e.reportAllChanges)})))}))},W=[],_=new Map,z=[],G=new WeakMap,J=-1,K=function(t){t.forEach((function(t){return W.push(t)}))},Q=function(){z=z.slice(-10);var t=new Set(z.concat(P.map((function(t){return G.get(t.entries[0])}))));_.forEach((function(e,n){t.has(n)||_.delete(n)}));var e=new Set;_.forEach((function(t){tt(t.startTime,t.processingEnd).forEach((function(t){e.add(t)}))})),W=Array.from(e),J=-1};H.push((function(t){for(var e,n=t.startTime+t.duration,r=z.length-1;r>=0;r--)if(e=z[r],Math.abs(n-e)<=8){var i=_.get(e);i.startTime=Math.min(t.startTime,i.startTime),i.processingStart=Math.min(t.processingStart,i.processingStart),i.processingEnd=Math.max(t.processingEnd,i.processingEnd),i.entries.push(t),n=e;break}n!==e&&(z.push(n),_.set(n,{startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,entries:[t]})),(t.interactionId||"first-input"===t.entryType)&&G.set(t,n),J<0&&(J=j(Q))}));var X,Y,Z,$,tt=function(t,e){for(var n,r=[],i=0;n=W[i];i++)if(!(n.startTime+n.duration<t)){if(n.startTime>e)break;r.push(n)}return r},et=function(t,n){e||(e=l("long-animation-frame",K)),V((function(e){j((function(){!function(t){var e=t.entries[0],n=G.get(e),i=_.get(n),o=e.processingStart,u=i.processingEnd,c=i.entries.sort((function(t,e){return t.processingStart-e.processingStart})),s=tt(e.startTime,u),f=t.entries.find((function(t){return t.target})),l=[e.startTime+e.duration,u].concat(s.map((function(t){return t.startTime+t.duration}))),d=Math.max.apply(Math,l);t.attribution={interactionTarget:a(f&&f.target),interactionType:e.name,interactionTime:e.startTime,nextPaintTime:d,processedEventEntries:c,longAnimationFrameEntries:s,inputDelay:o-e.startTime,processingDuration:u-o,presentationDelay:Math.max(d-u,0),loadState:r(e.startTime)}}(e),t(e)}))}),n)},nt=[2500,4e3],rt={},it=function(t,e){!function(t,e){e=e||{},b((function(){var n,r=S(),i=f("LCP"),a=function(t){var e=t[t.length-1];e&&e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-s(),0),i.entries=[e],n())},o=l("largest-contentful-paint",a);if(o){n=d(t,i,nt,e.reportAllChanges);var u=v((function(){rt[i.id]||(a(o.takeRecords()),o.disconnect(),rt[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(t){addEventListener(t,(function(){return j(u)}),!0)})),p(u),c((function(r){i=f("LCP"),n=d(t,i,nt,e.reportAllChanges),m((function(){i.value=performance.now()-r.timeStamp,rt[i.id]=!0,n(!0)}))}))}}))}((function(e){!function(t){if(t.entries.length){var e=n();if(e){var r=e.activationStart||0,i=t.entries[t.entries.length-1],o=i.url&&performance.getEntriesByType("resource").filter((function(t){return t.name===i.url}))[0],u=Math.max(0,e.responseStart-r),c=Math.max(u,o?(o.requestStart||o.startTime)-r:0),s=Math.max(c,o?o.responseEnd-r:0),f=Math.max(s,i?i.startTime-r:0),l={element:a(i.element),timeToFirstByte:u,resourceLoadDelay:c-u,resourceLoadTime:s-c,elementRenderDelay:f-s,navigationEntry:e,lcpEntry:i};return i.url&&(l.url=i.url),o&&(l.lcpResourceEntry=o),void(t.attribution=l)}}t.attribution={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadTime:0,elementRenderDelay:t.value}}(e),t(e)}),e)},at=[800,1800],ot=function t(e){document.prerendering?b((function(){return t(e)})):"complete"!==document.readyState?addEventListener("load",(function(){return t(e)}),!0):setTimeout(e,0)},ut=function(t,e){e=e||{};var r=f("TTFB"),i=d(t,r,at,e.reportAllChanges);ot((function(){var a=n();if(a){var o=a.responseStart;if(o<=0||o>performance.now())return;r.value=Math.max(o-s(),0),r.entries=[a],i(!0),c((function(){r=f("TTFB",0),(i=d(t,r,at,e.reportAllChanges))(!0)}))}}))},ct=function(t,e){ut((function(e){!function(t){if(t.entries.length){var e=t.entries[0],n=e.activationStart||0,r=Math.max(e.domainLookupStart-n,0),i=Math.max(e.connectStart-n,0),a=Math.max(e.requestStart-n,0);t.attribution={waitingTime:r,dnsTime:i-r,connectionTime:a-i,requestTime:t.value-a,navigationEntry:e}}else t.attribution={waitingTime:0,dnsTime:0,connectionTime:0,requestTime:0}}(e),t(e)}),e)},st={passive:!0,capture:!0},ft=new Date,lt=function(t,e){X||(X=e,Y=t,Z=new Date,pt(removeEventListener),dt())},dt=function(){if(Y>=0&&Y<Z-ft){var t={entryType:"first-input",name:X.type,target:X.target,cancelable:X.cancelable,startTime:X.timeStamp,processingStart:X.timeStamp+Y};$.forEach((function(e){e(t)})),$=[]}},mt=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var n=function(){lt(t,e),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,st),removeEventListener("pointercancel",r,st)};addEventListener("pointerup",n,st),addEventListener("pointercancel",r,st)}(e,t):lt(e,t)}},pt=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,mt,st)}))},vt=[100,300],ht=function(t,e){e=e||{},b((function(){var n,r=S(),i=f("FID"),a=function(t){t.startTime<r.firstHiddenTime&&(i.value=t.processingStart-t.startTime,i.entries.push(t),n(!0))},o=function(t){t.forEach(a)},u=l("first-input",o);n=d(t,i,vt,e.reportAllChanges),u&&(p(v((function(){o(u.takeRecords()),u.disconnect()}))),c((function(){var r;i=f("FID"),n=d(t,i,vt,e.reportAllChanges),$=[],Y=-1,X=null,pt(addEventListener),r=a,$.push(r),dt()})))}))},gt=function(t,e){ht((function(e){!function(t){var e=t.entries[0];t.attribution={eventTarget:a(e.target),eventType:e.name,eventTime:e.startTime,eventEntry:e,loadState:r(e.startTime)}}(e),t(e)}),e)};export{M as CLSThresholds,L as FCPThresholds,vt as FIDThresholds,U as INPThresholds,nt as LCPThresholds,at as TTFBThresholds,w as onCLS,x as onFCP,gt as onFID,et as onINP,it as onLCP,ct as onTTFB};
